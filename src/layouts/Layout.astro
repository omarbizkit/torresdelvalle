---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

export interface Props {
  title: string;
  description: string;
  image?: string;
  locale?: 'es' | 'en';
  headerTheme?: 'light' | 'dark';
}

const { 
  title, 
  description, 
  image = '/images/hero-vineyard.jpg',
  locale = 'es',
  headerTheme = 'light'
} = Astro.props;

const siteUrl = 'https://torresdelvalle.mx';
const fullTitle = `${title} | Torres del Valle, Valle de Guadalupe`;
---

<!DOCTYPE html>
<html lang={locale} class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta name="format-detection" content="telephone=no" />
    
    <!-- Open Graph -->
    <meta property="og:title" content={fullTitle} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={`${siteUrl}${image}`} />
    <meta property="og:url" content={`${siteUrl}${Astro.url.pathname}`} />
    <meta property="og:locale" content={locale === 'es' ? 'es_MX' : 'en_US'} />
    <meta property="og:type" content="website" />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={fullTitle} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={`${siteUrl}${image}`} />
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="apple-touch-icon" href="/favicon.png" />
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=Inter:wght@400;500;600&family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet" />
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Anime.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    
    <title>{fullTitle}</title>
  </head>
  
  <body class="bg-crema text-charcoal font-body text-lg leading-relaxed">
    <!-- Skip Link -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-clay text-crema px-4 py-2 rounded z-50">
      {locale === 'es' ? 'Saltar al contenido principal' : 'Skip to main content'}
    </a>
    
    <!-- Header -->
    <Header currentLocale={locale} headerTheme={headerTheme} />
    
    <!-- Main Content -->
    <main id="main-content">
      <slot />
    </main>
    
    <!-- Footer -->
    <Footer />
    
    <!-- Scripts -->
    <script>
      // Initialize animations when DOM is loaded
      document.addEventListener('DOMContentLoaded', function() {
        // Reveal animations on scroll
        const observerOptions = {
          threshold: 0.1,
          rootMargin: '0px 0px -100px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animate-active');
            }
          });
        }, observerOptions);
        
        // Observe all elements with reveal class
        document.querySelectorAll('.reveal').forEach(el => {
          observer.observe(el);
        });
      });
    </script>

    <style is:global>
      :root {
        --clay: #B8573E;
        --vineyard: #5A604E;
        --crema: #F6F3EB;
        --charcoal: #2C2C2C;
      }

      body {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
      }

      ::selection {
        background-color: var(--clay);
        color: var(--crema);
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: var(--crema);
      }
      ::-webkit-scrollbar-thumb {
        background: var(--vineyard);
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: var(--clay);
      }

      /* Premium Animations */
      .reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: all 1.2s cubic-bezier(0.22, 1, 0.36, 1);
        will-change: transform, opacity;
      }

      .reveal.animate-active {
        opacity: 1;
        transform: translateY(0);
      }

      .animate-fadeIn {
        animation: fadeIn 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
      }

      .animate-slideUp {
        animation: slideUp 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      @keyframes slideUp {
        from { opacity: 0; transform: translateY(40px); }
        to { opacity: 1; transform: translateY(0); }
      }

      /* Typography Refinements */
      .font-display {
        font-family: 'Cormorant Garamond', serif;
      }
      .font-body {
        font-family: 'Inter', sans-serif;
      }
      
      h1, h2, h3, h4 {
        letter-spacing: -0.02em;
      }
      
      .prose p {
        margin-bottom: 1.5em;
        line-height: 1.8;
      }
    </style>
  </body>
</html>

<!-- JSON-LD Structured Data -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "LocalBusiness",
  "name": "Torres del Valle",
  "description": description,
  "url": siteUrl,
  "telephone": "+526461234567",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Km 85",
    "addressLocality": "Valle de Guadalupe",
    "addressRegion": "Ensenada, Baja California",
    "addressCountry": "MX"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "32.0833",
    "longitude": "-116.5833"
  },
  "openingHoursSpecification": [
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": ["Wednesday", "Thursday", "Friday", "Saturday", "Sunday"],
      "opens": "11:00",
      "closes": "18:00"
    }
  ],
  "image": `${siteUrl}${image}`,
  "priceRange": "$$"
})} />
